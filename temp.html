
<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>GWPC RBDMS National Oil & Gas Gateway</title>
    <!-- Bootstrap -->
    
    <link href="/GatewayWeb/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/GatewayWeb/css/gateway.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/GatewayWeb/js/bootstrap.min.js"></script>


    <link href="/GatewayWeb/css/jquery-ui.css" rel="stylesheet" />
    <link href="/GatewayWeb/css/ui.jqgrid.css" rel="stylesheet" />
    <script src="/GatewayWeb/js/grid.locale-en.js"></script>
    <script src="/GatewayWeb/js/jquery-ui.js"></script>
    <script src="/GatewayWeb/js/jquery.jqGrid.js"></script>
    
    <script src="/GatewayWeb/js/grid.treegrid.js"></script>

    <script src="http://maps.google.com/maps/api/js?v=3.6&amp;sensor=false"></script>
    <script src="/GatewayWeb/OpenLayers-2.13.1/OpenLayers.js"></script>
    <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <script src="/GatewayWeb/js/RBDMSGIS_HTML_OL.js"></script>
    <script src="/GatewayWeb/js/javascript.util.js"></script>
    <script src="/GatewayWeb/js/jsts.js"></script>
    <script src="/GatewayWeb/js/jquery.multiSelect.js"></script>
    <link href="/GatewayWeb/css/jquery.multiSelect.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <div class="navbar-brand">
                        <a class="pull-left" rel="home" href="#" title="GWPC" id="gwpclogo">
                            <img id="logo-image" alt="" src="/GatewayWeb/images/GWPC_logo_rgb.gif" />
                        </a>
                        <p class="logo-text">GWPC | RBDMS<br />National Oil & Gas Gateway</p>
                    </div>
                    <button id="btn-navbar" type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul id="navbarUl" class="nav navbar-nav navbar-right header-menu-on-small header-menu-on-big">
                        <li class="header-menu-li-on-small header-menu-first-li-on-small" id="li-chrome"><a href="/GatewayWeb/Home/Index" class="mainmenu_back">HOME</a></li>
                        <li class="header-menu-li-on-small dropdown" id="liTools">
                            <a href="#" class="dropdown-toggle mainmenu_back" data-toggle="dropdown" role="button" aria-expanded="false"><span class="dropdown-on-small" id="spanTools">TOOLS </span><span class="caret"></span></a>
                            <div class="dropdown-menu horizontaladjust" role="menu" id="divTools" onmouseover="divToolsMouseOver();" onmouseout="divToolsMouseOut();">
                                <table class="toolsonbig">
                                    <tr>
                                        <td style="min-width: 230px;"></td>
                                        <td class="nav-link-header"><p class="nav-link-header-text">DATA VIEWS</p></td>
                                    </tr>
                                    <tr>
                                        <td><h3>Map View</h3><p style="font-size:16px">Text describing the Map View page and functionality</p></td>
                                        <td class="views-icon-and-text"><img alt="" src= "/GatewayWeb/images/map-view.png"><a href="/GatewayWeb/Home/MapView" style="font-size: 18px;">Map View</a></td>
                                    </tr>
                                    <tr>
                                        <td><h3>Data View</h3><p style="font-size:16px">Text describing the Data View page and functionality</p></td>
                                        <td class="views-icon-and-text"><img alt="" src= "/GatewayWeb/images/data-view.png"><a href="/GatewayWeb/Home/DataView" style="font-size: 18px;">Data View</a></td>
                                    </tr>
                                </table>
                            </div>
                            <ul class="nav toolsonsmall header-sub-menu-on-small">
                                <li class="header-menu-li-on-small"><a href ="/GatewayWeb/Home/MapView" class="mainmenu_back"><p class="tab-on-small">Map View</p></a></li>
                                <li class="header-menu-li-on-small"><a href="/GatewayWeb/Home/DataView" class="mainmenu_back"><p class="tab-on-small">Data View</p></a></li>
                            </ul>
                        </li>
                        <li class="header-menu-li-on-small"><a href="#" class="mainmenu_back">ABOUT</a></li>
                        <li class="header-menu-li-on-small"><a href="#" class="mainmenu_back">CONTACT US</a></li>
                        <li class="header-menu-li-on-small"><a href="#" data-toggle="modal" data-target="#loginModal" id="href_login" class="mainmenu_back">LOG IN</a></li>
                        <li class="header-menu-li-on-small"><a href="#" class="mainmenu_back" id="link_chngpass" style="display:none" data-toggle="modal" data-target="#chgPassModal">Change Password</a></li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div><!--/.container-fluid -->
        </nav>
        <div>
            


<div class="container">
  
  
    <div class="row">
        <div class="col-sm-6">
            <div class="btn-toolbar" role="toolbar">
                <div class="btn-group map-toolbar">
                    <button id="btnMove" type="button" onclick="javascript: arby.setDefaultTool(); return null;" class="btn btn-maptool ui-icon-move" aria-label=""></button>
                    <button id="btnSelect" type="button" onclick="javascript: arby.activateSelectControl(['Wells Selection'], 'wellSelectionControl'); arby.setTooltip(false); return null;" class="btn btn-maptool ui-icon-select" aria-label=""></button>
                    <button id="btnZoomFull" type="button" onclick="javascript: zoomFull(); return null;" class="btn btn-maptool ui-icon-zoomfull" aria-label=""></button>
                    <button id="btnSelectRect" type="button" onclick="javascript: arby.activateSelectControl(['Wells Selection'], 'wmsGetFeatureControl'); arby.setTooltip(false); return null;" class="btn btn-maptool ui-icon-selectrect" aria-label=""></button>
                    <button id="btnSelectPoly" type="button" onclick="javascript: arby.activateSelectControl(['Wells Selection'], 'polySelectControl'); arby.setTooltip(false); return null;" class="btn btn-maptool ui-icon-selectpoly" aria-label=""></button>
                    <button id="btnClearFilt" type="button" onclick="javascript: clearSelection(); return null;" class="btn btn-maptool ui-icon-deselect" aria-label=""></button>
                    <div id="selectioninfo"></div>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <a class="btn btn-default btn-sm" href="/GatewayWeb/Home/DataView" role="button">DATA VIEW</a>
            <!--<a class="btn btn-danger btn-sm" href="#" role="button">GUIDE ME</a>-->
            <button type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#wizardModal">GUIDE ME</button>
            <div id="loading">loading</div>
            <div id="progressbar"></div>
        </div>
    </div>
    <div class="row content-area">
        <div class="col-sm-12 olMap-container">
            <div id="olMap"></div>
        </div>
        <div class="row totals-area" >
            <div class="col-sm-9" style="width:100%; margin-left:30px">
                <div class="row">
                    <div class="col-sm-10">
                        <div class="row bottom-panel-left" style="border-bottom:solid; border-bottom-color:lightgray; height:34px;">
                            <div class="col-sm-9">
                                <b>TOTALS</b>
                            </div>
                            <div class="col-sm-3">
                                <!--<a class="btn btn-primary btn-sm" href="#" role="button">DOWNLOAD</a>-->
                                <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#downloadModal">DOWNLOAD</button>
                            </div>
                        </div>
                        <div class="row bottom-panel-left" style="height:48px;">
                            <div class="col-sm-3" style="text-align:center;">
                                <b>GAS</b><br /><input id="gas-total" type="text" value="" class="bottom-panel-input" />
                            </div>
                            <div class="col-sm-3" style="text-align:center;">
                                <b>OIL</b><br /><input id="oil-total" type="text" value="" class="bottom-panel-input" />
                            </div>
                            <div class="col-sm-3" style="text-align:center;">
                                <b>WATER</b><br /><input id="water-total" type="text" value="" class="bottom-panel-input" />
                            </div>
                            <div class="col-sm-3" style="text-align:center; border-left:solid; border-left-color:lightgray;">
                                <b>WELLS</b><br /><input id="wells-total" type="text" value="" class="bottom-panel-input" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="row bottom-panel-right">
                            <div class="col-sm-6 charts-align">
                                <b>CHARTS</b>
                            </div>
                            <div class="col-sm-6">
                                <button type="button" class="btn btn-sm disable-border-radius pin-background-color charts-btn" data-toggle="modal" data-target="#areaModal"><img src="/GatewayWeb/images/Area.png" /></button>
                                <button type="button" class="btn btn-sm disable-border-radius pin-background-color charts-btn" data-toggle="modal" data-target="#lineModal"><img src="/GatewayWeb/images/Line.png" /></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>   
    </div>
  
    <!-- Modal -->
    <div class="modal fade" id="lineModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Production Totals</h4>
                </div>
                <div class="modal-body" id="line-chart-content">
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="areaModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Production Totals</h4>
                </div>
                <div class="modal-body" id="area-chart-content">
                    
                </div>
            </div>
        </div>
    </div>
   
  
</div> <!-- /container -->


<script type="text/javascript">


   // debugger;


    var currentFilter = 0;

    function getFilterString() {
        var grid = $('#treegrid');
        var filtergrid = $('#filter');
        var m = filtergrid.getDataIDs();
        var localIdName = filtergrid.jqGrid("getGridParam", "localReader").id;
        var filterstring = "";
        var skiplevel = 100;

        for (var i = 0; i < m.length; i++) {
            localData = filtergrid.jqGrid("getLocalRow", m[i]);
            if (localData["level"] > skiplevel)
                continue;
            skiplevel = 100;
            var checked = $("#" + localData[localIdName] + " input.itmchk").prop("checked");
            if (checked) {
                filterstring += localData["id"] + ",";
                if (localData["isLeaf"] == false)
                    skiplevel = localData["level"];
            }
        }
      //  debugger;
        return filterstring;
    }


    function applyFilter() {
        var prevfilter;
        $.ajax({
            type: "POST",
            //data: { filterid: currentFilter },
            url: '/GatewayWeb/Home/GetFilterId',
            async: false,
            success: function (xhr) {
                //         debugger;
                prevfilter = xhr;
            },
            error: function (xhr, errorThrown) { alert(errorThrown); }

        });

        //var teszturl = '/GatewayWeb/Home/GetResult' + "/";
        $.ajax({
            type: "post",
            dataType: 'json',
            contentType: "application/json",
            data: '{filter: "' + getFilterString() + '"}',
            url: '/GatewayWeb/Home/PostFilters',
            success: function (data) {
                currentFilter = data;
               


                // debugger;
                //if filter changed on the current page OR in the session
                if (prevfilter != currentFilter||(currentFilter==0&& prevfilter==0)) {

                    

                    updateTotalsSum(currentFilter, $("#oil-total"), $("#gas-total"), $("#water-total"), $("#wells-total"));
                    updateCharts(currentFilter, $("#area-chart-content"), $("#line-chart-content"));
                }



            },
            error: function (xhr, status, error) {
                var err = eval("(" + xhr.responseText + ")");
                alert(err.Message);
            }
        });
    }



    var geoserverURL = "http://gatewaybeta.gwpc.org:8080";
    var geoserverNS = "OGDG";

    var arby = RBDMSGIS;

    function setupMap() {

        arby.useThemeLayer = false;

        arby.urlPrefix = window.location.href.replace("Home/MapView", "").replace(/\/+$/, '');

        var res = arby.setupMap('olMap');

        arby.addSelectionCallback(selectionCallback);

        var mLayers = arby.olMap.layers;

        // register events for the bkgnd layers
        for (var a = 0; a < mLayers.length; a++) {
            if (mLayers[a].isBaseLayer)
                registerProgressEvents(mLayers[a]);
        };

        OpenLayers.ProxyHost = arby.urlPrefix + "/proxyReverse.ashx?url=";

        addDynamicLayers();

        zoomFull();

        //arby.olMap.setCenter(
        //    new OpenLayers.LonLat(-71.147, 42.472).transform(
        //        new OpenLayers.Projection("EPSG:4326"),
        //        arby.olMap.getProjectionObject()
        //        ), 12
        //);
    }

    var WellLoc;
    var OGDPWellsSelection;
    var Basins, Plays;
    var CDists;
    var Faults, Geol;
    var hBasins4, hBasins8;

    var vectors;

    // temp hack to replace legend url-s (geowebcache bug)
    function getFullRequestString(newParams, altUrl) {
        var req = OpenLayers.Layer.WMS.prototype.getFullRequestString.call(this, newParams, altUrl);
        if (newParams.hasOwnProperty('REQUEST') && newParams.REQUEST == 'GetLegendGraphic')
            return req.replace("/gwc/service", "");
        return req;
    }

    function addDynamicLayers() {
        Basins = new OpenLayers.Layer.WMS(
				"Shale Basins",
				geoserverURL + "/geoserver/gwc/service/wms",
				{ layers: geoserverNS + ":ShaleBasins", transparent: true, tiled: false }
		   );
        Basins.visibility = true;
        Basins.getFullRequestString = getFullRequestString;
        Basins.description = Basins.name;
        registerProgressEvents(Basins);
        arby.olMap.addLayer(Basins);

        Plays = new OpenLayers.Layer.WMS(
				"Shale Plays",
				geoserverURL + "/geoserver/gwc/service/wms",
				{ layers: geoserverNS + ":ShalePlays", transparent: true, tiled: false }
		   );
        Plays.visibility = false;
        Plays.getFullRequestString = getFullRequestString;
        Plays.description = Plays.name;
        registerProgressEvents(Plays);
        arby.olMap.addLayer(Plays);

        WellLoc = new OpenLayers.Layer.WMS(
             "SQLWells",
             geoserverURL + "/geoserver/gwc/service/wms",
             { layers: geoserverNS + ":WellLocShape2", transparent: true, tiled: false }
        );
        WellLoc.visibility = true;
        WellLoc.getFullRequestString = getFullRequestString;
        WellLoc.description = WellLoc.name;
        registerProgressEvents(WellLoc);
        arby.olMap.addLayer(WellLoc);

        OGDPWellsSelection = new OpenLayers.Layer.WMS(
                "Wells Selection",
                geoserverURL + "/geoserver/wms",
                { layers: geoserverNS + ":WellLocShape", transparent: true, tiled: false },
                { displayInLayerSwitcher: false }
           );
        OGDPWellsSelection.visibility = false;
        arby.olMap.addLayer(OGDPWellsSelection);

        var control = new OpenLayers.Control.GetFeature({
            id: "wellSelectionControl",
            protocol: OpenLayers.Protocol.WFS.fromWMSLayer(OGDPWellsSelection),
            box: true,
            hover: true,
            multipleKey: "shiftKey",
            toggleKey: "ctrlKey",
            maxFeatures: 1
        });

        hover = new OpenLayers.Layer.Vector("Hover", { displayInLayerSwitcher: false });
        arby.olMap.addLayer(hover);

        // hook into the hover handler to allow pausing hover
        var enableHover = true;
        control.handlers.hover = new OpenLayers.Handler.Hover(
            control, {
                'move': function () {
                    if (enableHover)
                        control.cancelHover();
                },
                'pause': function (evt) {
                    if (enableHover)
                        control.selectHover(evt);
                }
            },
            OpenLayers.Util.extend(control.handlerOptions.hover, {
                'delay': 250,
                'pixelTolerance': 2
            })
        );

        control.events.register("hoverfeature", this, function (e) {
            hover.addFeatures([e.feature]);
            var feature = e.feature;
            var popup = new OpenLayers.Popup.FramedCloud(
					"idWindow",
					OpenLayers.LonLat.fromString(e.feature.geometry.toShortString()),
		                        null,
					"<div id='popupDiv' class='pdiv'><table id='popupTable'><tr><td class='pname'>API:</td><td>" + getWellLink(feature.attributes.API, feature.attributes.StWellKey) + "</td><td class='pname'>Operator:</td><td>" + feature.attributes.OperatorNa + "</td></tr><tr><td class='pname'>Status:</td><td>" + feature.attributes.StDesc + "</td><td class='pname'>Type:</td><td>" + feature.attributes.TypeDesc + "</td></tr></table><div id='popupChart'></div></div>"
, null, true, function () {
    for (var i = 0; i < hover.features.length; i++) {
        var feature = hover.features[i];
        if (feature.popup != null) {
            arby.olMap.removePopup(feature.popup);
            feature.popup.destroy();
            feature.popup = null;
        }
    }
    hover.removeAllFeatures();
    control.handlers.hover.clearTimer();
    enableHover = true;
}
			);

            feature.popup = popup;
            arby.olMap.addPopup(popup);
            enableHover = false;
            $(".olPopup").css("z-index", 10000);
            $("#idWindow")
			.mouseenter(function () {
			    enableHover = false;
			})
			.mouseleave(function () {
			    enableHover = true;
			});
            $("#idWindow_GroupDiv").append("<div id='idWindow_pinButton' title='add to pinned wells' onclick='javascript: addToPinnedWells(&quot;" + feature.attributes.API + "&quot;); return null;' />");
            $('#popupChart').html("Loading content from server...");
            $.getJSON('/GatewayWeb/Home/GetWellProductionTotals', "wellAPI=" + feature.attributes.API,
                function (data) {
                    if (data.rows.length > 0)
                        Showdata(data);
                    else
                        $('#popupChart').html("<span style=\"color:green\">No production data available</span>");
                })
            .error(function () {
                $('#popupChart').html("<span style=\"color:red\">Could not access server content!</span>");
            });
        });

        control.events.register("deactivate", this, function (e) {
            for (var i = 0; i < hover.features.length; i++) {
                var feature = hover.features[i];
                if (feature.popup != null) {
                    arby.olMap.removePopup(feature.popup);
                    feature.popup.destroy();
                    feature.popup = null;
                }
            }
            hover.removeAllFeatures();
            control.handlers.hover.clearTimer();
            enableHover = true;
        });

        control.events.register("outfeature", this, function (e) {
            hover.removeFeatures([e.feature]);
            var feature = e.feature;
            if (feature.popup != null) {
                arby.olMap.removePopup(feature.popup);
                feature.popup.destroy();
                feature.popup = null;
            }
        });

        arby.olMap.addControl(control);
        arby.singleUseTools.push("wellSelectionControl");

        CDists = new OpenLayers.Layer.WMS(
                "Congressional Dists",
                geoserverURL + "/geoserver/gwc/service/wms",
                { layers: geoserverNS + ":CONGDIST113", transparent: true, tiled: false }
           );
        CDists.visibility = false;
        CDists.getFullRequestString = getFullRequestString;
        CDists.description = CDists.name;
        registerProgressEvents(CDists);
        arby.olMap.addLayer(CDists);

        //************
        Faults = new OpenLayers.Layer.WMS(
                "Faults",
                geoserverURL + "/geoserver/gwc/service/wms",
                { layers: geoserverNS + ":FAULTS", transparent: true, tiled: false }
           );
        Faults.visibility = false;
        Faults.getFullRequestString = getFullRequestString;
        Faults.description = Faults.name;
        registerProgressEvents(Faults);
        arby.olMap.addLayer(Faults);

        //************
        Geol = new OpenLayers.Layer.WMS(
                "Surface Geol",
                geoserverURL + "/geoserver/gwc/service/wms",
                { layers: geoserverNS + ":GEO", transparent: true, tiled: false }
           );
        Geol.visibility = false;
        Geol.getFullRequestString = getFullRequestString;
        Geol.description = Geol.name;
        registerProgressEvents(Geol);
        arby.olMap.addLayer(Geol);

        //************
        hBasins8 = new OpenLayers.Layer.WMS(
                "Hydro Basins (8 dig)",
                geoserverURL + "/geoserver/gwc/service/wms",
                { layers: geoserverNS + ":WBD_HU8", transparent: true, tiled: false }
           );
        hBasins8.visibility = false;
        hBasins8.getFullRequestString = getFullRequestString;
        hBasins8.description = hBasins8.name;
        registerProgressEvents(hBasins8);
        arby.olMap.addLayer(hBasins8);

        //************
        hBasins4 = new OpenLayers.Layer.WMS(
                "Hydro Basins (4 dig)",
                geoserverURL + "/geoserver/gwc/service/wms",
                { layers: geoserverNS + ":WBD_HU4", transparent: true, tiled: false }
           );
        hBasins4.visibility = false;
        hBasins4.getFullRequestString = getFullRequestString;
        hBasins4.description = hBasins4.name;
        registerProgressEvents(hBasins4);
        arby.olMap.addLayer(hBasins4);

        vectors = new OpenLayers.Layer.Vector("Vectors", { displayInLayerSwitcher: false });
        vectors.setVisibility(false);
        arby.olMap.addLayer(vectors);
    }

    function Showdata(result) {
        var options = {
            displayAnnotations: true,
            vAxis: { logScale: false },
            hAxis: { title: 'Year', format: '####' }
        };

        var data = new google.visualization.DataTable(result);

        var chart = new google.visualization.LineChart(document.getElementById('popupChart'));
        chart.draw(data, options);
    }

    function addToPinnedWells(api) {
        SaveCompWellId(api, 1);
    }

    function getWellLink(API, StateWellKey) {
        var StateCode = API.substring(0, 2);
        if (StateCode == '01') return '<a target="_blank" href="http://www.gsa.state.al.us/ogb/results.aspx?api=' + API + '">' + API + '</a>';
        if (StateCode == '03') return '<a target="_blank" href="http://www.aogc2.state.ar.us/AOGConline/ED.aspx?KeyName=API_WELLNO&KeyValue=' + API + '0000&KeyType=STRING&DetailXML=WellDetails.xml">' + API + '</a>';
        if (StateCode == '05') return '<a target="_blank" href="http://cogcc.state.co.us/cogis/FacilityDetail.asp?facid=' + API.substring(2, 10) + '&type=WELL">' + API + '</a>';
        if (StateCode == '16') return '<a target="_blank" href="http://kgs.uky.edu/kgsweb/DataSearching/OILGAS/OGresults.asp?api=' + API + '0000&areatype=api">' + API + '</a>';
        if (StateCode == '23') return '<a target="_blank" href="http://gis.ogb.state.ms.us/MSOGBOnline/ED.aspx?KeyName=PKey&KeyValue=' + StateWellKey + '&KeyType=Integer&DetailXML=WellDetails.xml">' + API + '</a>';
        if (StateCode == '31') return '<a target="_blank" href="http://www.dec.ny.gov/cfmx/extapps/GasOil/search/wells/index.cfm?api=' + API + '">' + API + '</a>';
        if (StateCode == '54') return '<a target="_blank" href="https://apps.dep.wv.gov/oog/wellapisearch_new.cfm?api=' + API.substring(2, 10) + '">' + API + '</a>';
        if (StateCode == '26') return '<a target="_blank" href="http://www.nogcc.ne.gov/olNOGCCOnlineGIS/welllink_ne.aspx?APIWellNo=' + API + '">' + API + '</a>';
        return API;
    }

    function registerProgressEvents(layer) {
        layer.events.register("loadstart", layer, function () {
            $("#loading").css("display", "block");
            $("#loading").text("loading..");
            if (this.numLoadingTiles > 0)
                $("#progressbar").text("Loading " + layer.name + " (" + this.numLoadingTiles.toString() + " tiles left)");
            else
                $("#progressbar").text("Loading " + layer.name + "..");
        });

        layer.events.register("tileloaded", layer, function () {
            if (this.numLoadingTiles > 0)
                $("#progressbar").text("Loading " + layer.name + " (" + this.numLoadingTiles.toString() + " tiles left)");
            else
                $("#progressbar").text("Loading " + layer.name + "..");
        });

        layer.events.register("loadend", layer, function () {
            $("#loading").css("display", "none");
            $("#progressbar").text("");
        });
    }

    function zoomFull() {
        arby.olMap.setCenter(new OpenLayers.LonLat(-97, 39).transform(
            arby.geographic, arby.mercator), 4);
    }

    var currentSelection = null

    function setAsFilter() {
        //    debugger;
    }

    function pinSelection() {
        //  debugger;
    }

    function selectionCallback(res) {
        if (res.operation === "selectionstart") {
            $("#selectioninfo").html("querying...");
        }
        else if (res.operation === "selected") {
            var actions = ""
            if (res.features.length > 0) {
                actions += " <div id='selection_filterButton' title='set selection as filter' onclick='javascript: setAsFilter(); return null;' />";

                if (res.features.length <= 20)
                    actions += " <div id='selection_pinButton' title='add to pinned wells' onclick='javascript: pinSelection(); return null;' />";
            }
            currentSelection = res.features;
            if (res.features.length == 1) {
                $("#selectioninfo").html("selected 1 well" + actions);
                $("#btnClearFilt").button("enable");
            }
            else {
                $("#selectioninfo").html("selected " + res.features.length + " wells" + actions);
                $("#btnClearFilt").button("enable");
            }
        }
    }

    function clearSelection() {
        arby.clearSelection();
        $("#selectioninfo").html("");
        $("#btnClearFilt").button("disable");
    }

    function setAccordionIcon() {
        //$('.panel').on('hidden.bs.collapse', function (e) {
        //    if (e.currentTarget.id != "")
        //    $('#' + e.currentTarget.id + 'Title').removeClass("glyphicon-minus").addClass("glyphicon-plus");
        //})

        //$('.panel').on('shown.bs.collapse', function (e) {
        //    if (e.currentTarget.id != "")
        //    $('#' + e.currentTarget.id + 'Title').removeClass("glyphicon-plus").addClass("glyphicon-minus");
        //})
    }




    $(document).ready(function () {

        //MAP SETUP
        setupMap();


        loadPinnedWells();

        //setAccordionIcon();

        // Pinned button popover with image
        //$('[data-toggle="popover"]').popover();
        //$('a[rel=popover]').popover({
        //    html: true,
        //    trigger: 'hover',
        //    content: function () { return '<img src="' + $(this).data('img') + '" style="width: 192px; height: 115px;" />'; }
        //});


    });

    function selectallfunc() {
        $('.checkall').prop('checked', true);
    }

    function deselectallfunc() {
        $('.checkall').prop('checked', false);
    }

    function nextstepfunc() {
        var cont = $('#headerLine').text();



        if (cont.indexOf('1.') > -1) {
            $('#headerLine').text('2. Tell us WELL TYPE you want to search...');
            $('#headerdesc1').text('Choose Your WELL TYPES.');
            $('#headerdesc2').text('Click "NEXT" to move to step 3, or click "APPLY" to apply your filter(s) now.');

        }

        if (cont.indexOf('2.') > -1) {
            $('#headerLine').text('3. Tell us WELL STATUES, you want to search...');
            $('#headerdesc1').text('Choose Your WELL STATUES.');
            $('#headerdesc2').text('Click "NEXT" to move to step 4, or click "APPLY" to apply your filter(s) now.');
        }

        if (cont.indexOf('3.') > -1) {

            $('#headerLine').text('4. Tell us REPORTING PERIODS, you want to search...');
            $('#headerdesc1').text('Choose Your REPORTING PERIODS.');
            $('#headerdesc2').text('Click "APPLY" to apply your filter(s) now.');
        }

        if (cont.indexOf('4.') > -1) {
            $('#headerLine').text('1. Tell us WHERE you want to search...');
            $('#headerdesc1').text('Choose Your States/Countries.');
            $('#headerdesc2').text('Click "NEXT" to move to step 2, or click "APPLY" to apply your filter(s) now.');
        }

    }

    function prevstepfunc() {
        var cont = $('#headerLine').text();



        if (cont.indexOf('1.') > -1) {


            $('#headerLine').text('4. Tell us REPORTING PERIODS, you want to search...');
            $('#headerdesc1').text('Choose Your REPORTING PERIODS.');
            $('#headerdesc2').text('Click "APPLY" to apply your filter(s) now.');
        }

        if (cont.indexOf('2.') > -1) {


            $('#headerLine').text('1. Tell us WHERE you want to search...');
            $('#headerdesc1').text('Choose Your States/Countries.');
            $('#headerdesc2').text('Click "NEXT" to move to step 2, or click "APPLY" to apply your filter(s) now.');
        }

        if (cont.indexOf('3.') > -1) {
            $('#headerLine').text('2. Tell us WELL TYPE you want to search...');
            $('#headerdesc1').text('Choose Your WELL TYPES.');
            $('#headerdesc2').text('Click "NEXT" to move to step 3, or click "APPLY" to apply your filter(s) now.');

        }

        if (cont.indexOf('4.') > -1) {
            $('#headerLine').text('3. Tell us WELL STATUES, you want to search...');
            $('#headerdesc1').text('Choose Your WELL STATUES.');
            $('#headerdesc2').text('Click "NEXT" to move to step 4, or click "APPLY" to apply your filter(s) now.');
        }
    }

    function divToolsMouseOver() {
        var toolsLi = document.getElementById('liTools');
        var toolsSpan = document.getElementById('spanTools');
        toolsLi.classList.add('tools_hover');
        toolsSpan.classList.add('tools_hover');
    }

    function divToolsMouseOut() {
        var toolsLi = document.getElementById('liTools');
        var toolsSpan = document.getElementById('spanTools');
        toolsLi.classList.remove('tools_hover');
        toolsSpan.classList.remove('tools_hover');
    }



</script>

<script type="text/javascript">
    //filter grid
    $(document).ready(function () {

        loadfiltergrid();
        updateTotalsSum(currentFilter, $("#oil-total"), $("#gas-total"), $("#water-total"), $("#wells-total"));
        updateCharts(currentFilter, $("#area-chart-content"), $("#line-chart-content"));

        //$('#lineModal').on('shown.bs.modal', function () {
        //    drawProductionTotal('line', $("#line-chart-content"));
        //});

        //$('#areaModal').on('shown.bs.modal', function () {
        //    drawProductionTotal('area', $("#area-chart-content"));
        //});
    });
</script>

            <!--right menu-->
            <div class="right-pane filter-background-color">
                <div class="right-pane-arrow filter-background-color">
                    <div class="pane-title-text">
                        &lt;&lt;
                    </div>
                </div>
                <ul class="nav nav-pills nav-pane" style="margin-bottom:-55px;">
                    <li class="active"><a class="nav-pane-title filter-background-color" data-toggle="pill" href="#filters">FILTERS</a></li>
                    <li><a class="nav-pane-title pin-background-color" data-toggle="pill" href="#pinnedWells">PINNED WELLS</a></li>
                </ul>
                <div class="tab-content">
                    <div id="pinnedWells" class="tab-pane pin-background-color">
                        <div id="pinnbase" class="pin-background-color">
                            <div class="element-padding">
                                <button class="btn btn-default btn-sm disable-border-radius" data-toggle='modal' data-target='#compareModal' id="btn_compare">COMPARE</button>
                            </div>
                            <div class="element-padding">
                              
                                <div style="width: 100%;">
                                    <div style="color:white; width: 50%; display: inline; text-align:center;">
                                        Pinned Total
                                    </div>
                                    <div style="width: 50%; float:right;">
                                        <input id="pinnedTotal" type="text" value="0" style="width: 80%;" readonly="readonly" />
                                    </div>
                                </div>
                            </div>
                            <div id="pinnlistplace">
                                <a class="btn btn-default btn-sm disable-border-radius pinned-element" href="#" role="button" rel="popover" data-img="images/LineGraph.png" data-placement="left"><div>API: 01-125-22885-00-00 <b> x</b></div></a>
                                <a class="btn btn-default btn-sm disable-border-radius pinned-element" href="#" role="button" rel="popover" data-img="images/LineGraph.png" data-placement="left">API: 01-003-19975-00-00 <b> x</b></a>
                                <a class="btn btn-default btn-sm disable-border-radius pinned-element" href="#" role="button" rel="popover" data-img="images/LineGraph.png" data-placement="left">API: 01-203-20265-00-00 <b> x</b></a>
                            </div>
                            
                        </div>
                    </div>
                    <div id="filters" class="tab-pane active filter-background-color">
                        <div class="filter-background-color">
                            <div class="element-padding">
                                <button class="btn btn-default btn-sm disable-border-radius filter-background-color" onclick="applyFilter(); return null;" role="button">APPLY ALL</button>
                                <a class="btn btn-default btn-sm disable-border-radius filter-background-color" href="#" role="button">CLEAR ALL</a>
                            </div>
                            <div class="element-padding">
                                <div style="width: 100%;">
                                    <div style="color:white; width: 50%; display: inline; text-align:center;">
                                        Selected Total
                                    </div>
                                    <div style="width: 50%; float:right;">
                                        <input type="text" value="37,638" style="width: 80%;" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-group filter-background-color" id="accordionMain">
                            <div class="panel panel-default filter-background-color" id="panelStandard">
                                <div class="panel-heading filter-main-panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordionMain" href="#collapseStandard"><!--<span id="panelStandardTitle" class="glyphicon-minus"></span>-->STANDARD FILTERS</a>
                                    </h4>
                                </div>
                                <div id="collapseStandard" class="panel-collapse collapse in">
                                    <table id="filter"></table>
                                    <div id="pfilter"></div>
                                   
                                </div>
                            </div>
                            <div class="panel panel-default" id="panelAdvanced">
                                <div class="panel-heading filter-main-panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordionMain" href="#collapseAdvanced"><!--<span id="panelAdvancedTitle" class="glyphicon-plus"></span>-->ADVANCED FILTERS</a>
                                    </h4>
                                </div>
                                <div id="collapseAdvanced" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <p>Advanced filters</p>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

               
               
               
               
               
          
        </div>

      
        <!--Login modal-->
        <div class="modal fade" id="loginModal" role="dialog">
            <div class="modal-dialog">
                <div style="border-color:black; border-style:solid; border-width:2px ; width:560px; height:400px">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <button type="button" class="close" data-dismiss="modal" style="padding:5px">&times;</button>
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px">Admin Login</h4>
                    </div>
                    <div style="background-color:white;">
                        <p style="padding:10px; text-align:center">
                            Only administrative users may log into the National Oil and Gas Gateway.
                            If you are not an administrative user, click the CLOSE button to exit this menu.
                        </p>
                        <table style="width:440px">
                            <tr style="height:60px">
                                <td >
                                    
                                   <label style="margin-left:30px">Username</label> 
                                </td>
                            </tr>
                            <tr style="text-align:center">
                                <td><input type="text" id="tbox_uname" style="width:500px; height:40px;margin-left:30px;padding-left:5px" /></td>
                            </tr>
                            <tr style="height:60px; ">
                                <td >
                                    
                                    
                                    <label style="margin-left:30px">Password</label> 
                                </td>
                            </tr>
                            <tr style="height:60px; ">
                                <td style="text-align:center"><input  id="tbox_pword" type="password" style="width:500px; height:40px;margin-left:30px;padding-left:5px" /></td>
                            </tr>
                            <tr style="height:60px; ">
                                <td></td>
                            </tr>
                            <tr style="height:60px; width:500px">
                                <td style="text-align:center; "><button id="btn_login" onclick="login();" title="LOG IN" style="margin-left: 180px; display: block; vertical-align: central; height: 40px; width: 200px; color: white; background-color:#21409a; text-align: center; line-height: 40px;">LOG IN</button></td>
                            </tr>
                            <tr>
                                
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!--Change pasword modal-->
        <div class="modal fade" id="chgPassModal" role="dialog">
            <div class="modal-dialog">
                <div style="border-color:black; border-style:solid; border-width:2px ; width:560px; height:400px">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <button type="button" class="close" data-dismiss="modal" style="padding:5px">&times;</button>
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px">Change Password</h4>
                    </div>
                    <div style="background-color:white;">
                        <p style="padding:10px; text-align:center">
                            
                        </p>
                        <table style="width:440px">
                            <tr style="height:60px">
                                <td >
                                    
                                    <label style="margin-left:30px">Old Password</label> 
                                   
                                </td>
                            </tr>
                            <tr style="text-align:center">
                                <td><input type="text" id="tbox_old_pword" style="width:500px; height:40px;margin-left:30px;padding-left:5px" /></td>
                            </tr>
                            <tr style="height:60px; ">
                                <td >
                                    
                                    
                                    <label style="margin-left:30px">New Password</label> 
                                </td>
                            </tr>
                            <tr style="height:60px; ">
                                <td style="text-align:center"><input id="tbox_new_pword" type="password" style="width:500px; height:40px;margin-left:30px;padding-left:5px" /></td>
                            </tr>
                            <tr style="height:60px; ">
                                <td> <label style="margin-left:30px">Confirm Password</label> </td>
                            </tr>
                            <tr style="height:60px; ">
                                <td style="text-align:center"><input id="tbox_renew_pword" type="password" style="width:500px; height:40px;margin-left:30px;padding-left:5px" /></td>
                            </tr>
                            <tr style="height:60px; width:500px">
                                <td style="text-align:center; "><button id="btn_chg_pass" onclick="chg_password();"  data-dismiss="modal" title="Change Password" style="margin-left: 180px; display: block; vertical-align: central; height: 40px; width: 200px; color: white; background-color:#21409a; text-align: center; line-height: 40px;">Change Password</button></td>
                            </tr>
                           
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!--Download modal-->
        <div class="modal fade" id="downloadModal" role="dialog">
            <script type="text/javascript">
                jQuery(document).ready(function() {
                    $('#downloadModal').on('shown.bs.modal', function () {
                        initDwnLoadWizard();
                    });
                });

                function downloadData()
                {
                    jQuery("#dwlFinalbtn").prop("disabled", true);

                    var dwl_settings = [
                        {"selectcontrolname":"dwlchbWell","fileformat": null,"filterkey":"","dataset": null, "fields":null,"parameters":{}, "active":true},
                        {"selectcontrolname":"dwlchbProduction","fileformat": null,"filterkey":"","dataset": null, "fields":null,"parameters":{}, "active":true},
                        {"selectcontrolname":"dwlchbFormation","fileformat": null,"filterkey":"","dataset": null, "fields":null,"parameters":{},  "active":true},
                        {"selectcontrolname":"dwlchbPerforation","fileformat": null,"filterkey":"","dataset": null, "fields":null,"parameters":{},  "active":true}
                    ];

                    jQuery.each(dwl_settings,function (k,v) {
                        
                        if (jQuery("#" + v.selectcontrolname).prop("checked") === true)
                        {
                            v.fileformat = jQuery("#dwlfileformat").val();
                            v.filterkey = "";
                            v.dataset = jQuery("#" + v.selectcontrolname).val();

                            if (v.selectcontrolname === "dwlchbProduction")
                            {
                                if (jQuery("#dwlrMothly").prop("checked") === true)
                                    v.parameters.resolution = "MONTHLY";
                                else
                                    v.parameters.resolution = "YEARLY";
                            }
                            if (v.selectcontrolname === "dwlchbWell")
                            {
                                var gridData = jQuery("#dwnl_wellgrid").getRowData();
                                var ii = 0;var jj = 0;
                                for(ii = 0; ii < gridData.length; ii++)
                                {
                                    for(cname in gridData[ii])
                                    {
                                        if (cname.indexOf("colfor_") == 0)
                                        {
                                            delete gridData[ii][cname];
                                        }
                                    }
                                }
                                v.fields = gridData;
                            }

                        }
                        else
                        {
                            v.active = false;
                        }
                    });
                    


                    var postData = JSON.stringify(dwl_settings);
                    $.ajax({
                        type: "POST",
                        data: {configdata: postData},
                        url: "/GatewayWeb/Home/SetDwlParams",
                        async: true,
                        success: function () {
                            dwZip();
                            jQuery("#downloadModal").modal('hide');

                        },
                        error: function (xhr) {
                            alert(xhr.responsText);
                            jQuery("#dwlFinalbtn").prop("disabled", false);
                        }
                    });

                    
                }
                
                function dwZip()
                {
                    var dliframe = jQuery("#downloadframe");
                    dliframe.attr("src", "/GatewayWeb/Home/GetZipFile");
                }

                function dwlShowStep(step_no)
                {
                    jQuery('#step1').css('display', 'none');
                    jQuery('#step2').css('display', 'none');
                    jQuery('#step3').css('display', 'none');
                    jQuery('#step4').css('display', 'none');

                    jQuery("#step" + step_no).css('display', 'block');
                }

                function download_chkbox(cellvalue, options, rowObject) {
                    return "<input type='checkbox' value='inputtypecheckbox' name='want' checked />";
                }

                function stepDwnLoadWizard(delta)
                {
                    if (jQuery('#step1').css('display') == "block")
                    {
                        if (delta === 1)
                        {
                            dwlShowStep(2);
                        }
                    } else  if (jQuery('#step2').css('display') == "block")
                    {
                        if (delta === 1)
                        {
                            if (jQuery("#dwlchbProduction").prop("checked") === true)
                            {
                                dwlShowStep(3);
                            }
                            else
                            {
                                dwlShowStep(4);
                            }
                        } else  if (delta === -1)
                        {
                            dwlShowStep(1);
                        }
                    } else  if (jQuery('#step3').css('display') == "block")
                    {
                        if (delta === 1)
                        {
                                dwlShowStep(4);
                        } else  if (delta === -1)
                        {
                            dwlShowStep(2);
                        }

                    } else if (jQuery('#step4').css('display') == "block")
                    { 
                        if ((delta === -1) && (jQuery("#dwlchbProduction").prop("checked") === true))
                        {
                            dwlShowStep(3);
                        } else if (delta === -1)
                        {
                            dwlShowStep(2);
                        }
                    }
                }

                
                function setMainGridCellValue(value, mgridId, rowId,fieldName) {
                    jQuery("#" + mgridId).jqGrid("setCell", rowId, fieldName, value);
                }

                function gridControlChanged(event) {
                    var value = jQuery(event.target).val();
                    var mgridId = jQuery(event.target).attr("grid");
                    var rowId = jQuery(event.target).attr("row");
                    var fieldName = jQuery(event.target).attr("name");
                    if (value === "inputtypecheckbox")
                    {
                            value = jQuery(event.target).is(":checked");
                    }
                    if (value === "") {
                        value = null;
                    }
                    
                    setMainGridCellValue(value, mgridId, rowId, fieldName)
                }

                function initDwnLoadWizard() {

                    dwlShowStep(1);
                    jQuery("#dwlFinalbtn").prop("disabled", false);
                    jQuery("#dwlchbWell").prop("checked",true);
                    jQuery("#dwlchbProduction").prop("checked",true);
                    jQuery("#dwlchbFormation").prop("checked",true);
                    jQuery("#dwlchbPerforation").prop("checked",true);
                    jQuery("#dwlfileformat").val("FILECSV");
                    jQuery("#dwlrYearly").prop("checked", true);
                    var dwnloadGridData_Well = "";

                    dwnloadGridData_Well = [{"name":"wellIdentifier","label":"Well Identifier","hidden":false,"width":130},{"name":"state","label":"State","hidden":false,"width":30},{"name":"stateWellKey","label":"State Well Key","hidden":true,"width":0},{"name":"api","label":"API","hidden":false,"width":130},{"name":"type","label":"Type","hidden":true,"width":0},{"name":"typeDescription","label":"Type Description","hidden":false,"width":130},{"name":"status","label":"Status","hidden":true,"width":0},{"name":"statusDescription","label":"Status Desciption","hidden":false,"width":130},{"name":"stateOperatorKey","label":"State Operator Key","hidden":true,"width":0},{"name":"operatorName","label":"Operator Name","hidden":false,"width":250},{"name":"latitude","label":"Latitude","hidden":true,"width":0},{"name":"longitude","label":"Longitude","hidden":true,"width":0},{"name":"wellName","label":"Well Name","hidden":false,"width":250},{"name":"wellNumber","label":"Well Number","hidden":true,"width":0},{"name":"measuredDepth","label":"Measured Depth","hidden":true,"width":0},{"name":"totalVerticalDepth","label":"Total Vertical Depth","hidden":true,"width":0},{"name":"orientation","label":"Orientation","hidden":true,"width":0},{"name":"bottomHoleLatitude","label":"BottomHole Latitude","hidden":true,"width":0}];
 
                    if (dwnloadGridData_Well === "")
                    {
                        $.ajax({
                            type: "GET",
                            url: "/GatewayWeb/Home/GetDownloadWellColModel",
                            async: false,
                        success: function (data) {
                            dwnloadGridData_Well = data;
                        },
                        error: function (xhr) {
                            alert(xhr.responsText);
                            jQuery("#downloadModal").modal('hide');
                        }
                    });

                    }

                    jQuery('#dwnl_wellgrid').jqGrid({
                        data: dwnloadGridData_Well,
                        datatype: "local",
                        height: 'auto',
                        width: 445,
                        colNames: ['Select', 'Field Name', 'SysName', 'WANT' ],
                        colModel: [{ name: 'colfor_chkbox', index: 'colfor_chkbox', align: 'center', formatter: download_chkbox, editable: true, width: 70 },
                                    { name: 'label', index: 'label', align: 'left'  },
                                    { name: 'name', index: 'name', align: 'center', hidden: true },
                                    { name: 'want', index: 'want', align: 'center', hidden: true }
                        ],
                        sortname: 'name',
                        caption: '',
                        rowNum: 99999,
                        loadonce: false,
                        afterInsertRow: function (id) {
                            jQuery("#dwnl_wellgrid").find(":input").each(function() { if (typeof jQuery(this).attr("row") === "undefined") { jQuery(this).attr("row",id); } });
                            jQuery("#dwnl_wellgrid").find(":input").each(function() { if (typeof jQuery(this).attr("grid") === "undefined") { jQuery(this).attr("grid","dwnl_wellgrid"); } });

                            jQuery("#dwnl_wellgrid").find(":input").each(function() { if (typeof jQuery(this).attr("setE") === "undefined") { setMainGridCellValue(true,jQuery(this).attr("grid"),jQuery(this).attr("row"), jQuery(this).attr("name"));jQuery(this).bind("change", gridControlChanged );jQuery(this).bind("keyup", gridControlChanged ); jQuery(this).attr("setE","E"); } });
                
                        },

                        onSelectRow: function (id) {


                        },
                        loadComplete: function () {

                        }

                    });
                    $('#dwnl_wellgrid').jqGrid().trigger("reloadGrid");
                }
            </script>
            <iframe id="downloadframe" style="display:none"></iframe>
            <div class="modal-dialog">
                <div style="border-color:black; border-style:solid; border-width:2px ; width:450px" id="step1">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px">Choose <strong>File format</strong>, <strong>Dataset</strong> you want to download.</h4>
                    </div>
                    <div style="background-color:white;width:auto;text-align:center;">
                        <table style="width:auto;">
                            <tr style="height:60px">
                                <td style="width:33%; text-align:center;"><button type="button" class="close" data-dismiss="modal">CANCEL</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="close" style="width:100px;float:none;display:none;" onclick="stepDwnLoadWizard(-1);">Back</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="close" style="background-color:orangered !important; opacity:1.0; width:100px; height:30px; float:none " onclick="stepDwnLoadWizard(1);">Next</button></td>
                            </tr>
                            <tr style="height:60px">
                                <td colspan="1" style="text-align:center">
                                    File format
                                </td>
                                <td colspan="2" style="text-align:center">
                                    <select id="dwlfileformat" style="width:auto; margin-left:10px">
                                        <option value="FILECSV">CSV (Comma-separated values)</option>
                                        <option value="FILEXML">XML (Extensible Markup Language)</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" style="text-align:left;padding-left:30px;">
                                    <input type="checkbox" id="dwlchbWell" value="DatasetWell" checked disabled> <strong>Well</strong> dataset<br>
                                    <input type="checkbox" id="dwlchbProduction" value="DatasetProduction" checked> <strong>Production</strong> dataset<br>
                                    <input type="checkbox" id="dwlchbFormation" value="DatasetFormation" checked> <strong>Formation</strong> dataset<br>
                                    <input type="checkbox" id="dwlchbPerforation" value="DatasetPerforation" checked> <strong>Perforation</strong> dataset<br>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div style="border-color:black; border-style:solid; border-width:2px ; width:450px;display:none" id="step2">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px">Choose <strong>Well fields</strong> you want to download.</h4>
                    </div>
                    <div style="background-color:white;width:auto;text-align:center;">
                        <table style="width:100%;">
                            <tr style="height:60px">
                                <td style="width:33%; text-align:center;"><button type="button" class="close" data-dismiss="modal">CANCEL</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="close" style="width:100px; float:none" onclick="stepDwnLoadWizard(-1);">Back</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="close" style="background-color:orangered !important; opacity:1.0; width:100px; height:30px; float:none " onclick="stepDwnLoadWizard(1);">Next</button></td>
                            </tr>
                            <tr>
                                <td colspan="3" style="text-align:center">
                                    <table id="dwnl_wellgrid"></table>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div style="border-color:black; border-style:solid; border-width:2px ; width:450px;display:none" id="step3">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px">Choose <strong>Production resolution</strong>  you want to download.</h4>
                    </div>
                    <div style="background-color:white;width:auto;text-align:center;" id="stepscontainer">
                        <table style="width:100%;">
                            <tr style="height:60px">
                                <td style="width:33%; text-align:center;"><button type="button" class="close" data-dismiss="modal">CANCEL</button></td>
                                <td style="width: auto; text-align: center"><button type="button" class="close" style="width:100px; float:none" onclick="stepDwnLoadWizard(-1);">Back</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="close" style="background-color:orangered !important; opacity:1.0; width:100px; height:30px; float:none " onclick="stepDwnLoadWizard(1);">Next</button></td>
                            </tr>
                            <tr style="height:120px">
                                <td colspan="1" style="text-align:center">
                                    <input type="radio" name="dwlProductionRes" id="dwlrMothly" /> Monthly
                                </td>
                                <td colspan="1" style="text-align:center"></td>
                                <td colspan="1" style="text-align:center">
                                    <input type="radio" id="dwlrYearly" name="dwlProductionRes" checked/> Yearly
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div style="border-color:black; border-style:solid; border-width:2px ; width:450px;display:none" id="step4">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px"><strong>Download</strong></h4>
                    </div>
                    <div style="background-color:white;width:auto;text-align:center;" id="stepscontainer">
                        <table style="width:100%;">
                            <tr style="height:60px">
                                <td style="width:33%; text-align:center;"><button type="button" class="close" data-dismiss="modal">CANCEL</button></td>
                                <td style="width: auto; text-align: center"><button type="button" class="close" style="width:100px; float:none" onclick="stepDwnLoadWizard(-1);">Back</button></td>
                                <td style="width: 33%; text-align: center"><button type="button" class="btn btn-primary btn-sm" onclick="downloadData();" id="dwlFinalbtn">DOWNLOAD</button></td>
                            </tr>
                            <tr style="height:120px">
                                <td colspan="3" style="text-align:center"><h3>Download configuration is complete!</h3></td>
                            </tr>
                        </table>
                    </div>
                </div>

            </div>
        </div>
        <!--wizard modal-->
        <div class="modal fade" id="wizardModal" role="dialog">
            <div class="modal-dialog">
                <div style="border-color:black; border-style:solid; border-width:2px ; width:600px; background-color:#e0e0e0">
                    <div class="bottom-panel-right" style="height:50px; ">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:0px; padding-top:10px"><label id="headerLine">1. Tell us <strong>WHERE</strong> you want to search...</label></h4>
                    </div>
                    <div class="bottom-panel-right" style="height:60px; margin-top:30px">
                        <h4 style="color:white !important; margin-bottom:0px; margin-top:10px;  float:left; margin-left: 10px" id="headerdesc1"><label id="headerdesc1">Choose Your States/Countries.</label> </h4>
                        <label id="headerdesc2" style="color: white !important; margin-bottom: 0px; margin-top: 0px; float: left; margin-left: 10px"> Click 'NEXT' to move to step 2, or click 'APPLY' to apply your filter(s) now. </label>
                    </div>
                    <div style="background-color:#E0E0E0; min-height:300px">
                        <!--left side-->
                        <div style="float:left; width:50%">
                            <table style="width:280px; background-color:white; height:300px; margin-left:20px">
                                <tr style="height:30px; border-bottom-color:lightgray; border-bottom-style:solid; border-bottom-width:2px">
                                    <td style="width: 120px; text-align: center; border-right-color:lightgray; border-right-style:solid; border-right-width:2px">
                                        <button type="button" onclick="selectallfunc();" class="close" style="float:none; width:100px; color:rgb(40,96,144); opacity:1.0; font-size:1em">
                    Check All
                                        </button>
                                    </td>
                                    <td style="width: 120px; text-align: center"><button type="button" onclick="deselectallfunc();" class="close" data- style="float: none; width: 100px; color:rgb(40,96,144); opacity:1.0; font-size:1em">Uncheck All</button></td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <p style="margin-top:10px">
                                            <input type="checkbox" title="ALABAMA-AL" class="checkall" style="margin-left: 10px; margin-right: 10px" /><strong>ALABAMA-AL</strong> (37,638)
                                            <ul style="list-style:none; margin-left:10px">
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Autauga" style="margin-right:10px" />Autauga (14)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Baldvin" style="margin-right:10px" />Baldvin (5,203)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Barbour" style="margin-right:10px" />Barbour (0)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Bib" style="margin-right:10px" />Bib (241)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Blount" style="margin-right:10px" />Blount (4)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Bullock" style="margin-right:10px" />Bullock (6,711)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Butler" style="margin-right:10px" />Butler (58)
                                                </li>
                                                <li>
                                                    <input type="checkbox" class="checkall" title="Calhoun" style="margin-right:10px" />Calhoun (10,082)
                                                </li>
                                            </ul>
                                        </p>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <!--right side-->
                        <div style="float:right; width:50%">
                            <table style="width:280px">
                                <tr style="height:60px">
                                    <td style="width: 120px; text-align: center">
                                        <button type="button" class="close" style="float:none; width:100px; color:rgb(40,96,144); opacity:1.0">
                    APPLY()
                                        </button>
                                    </td>
                                    <td style="width: 120px; text-align: center"><button type="button" class="close" data-dismiss="modal" style="float: none; width: 100px; color:rgb(40,96,144); opacity:1.0">CANCEL</button></td>
                                </tr>
                                <tr style="height:150px">
                                    <td colspan="2" style="text-align:center">
                                        <label style="width:200px ;border-radius:20px; background-color:yellow; color:black">
                                            <label>Your current selected total</label><br />
                                            <label style="width:180px; background-color:white;border-radius:10px ; text-align:center">9,673,560</label>
                                        </label>
                                    </td>
                                </tr>
                                <tr style="height:60px">
                                    <td style="width: 120px; text-align: center"><button type="button" class="close" style="width:100px; float:none" onclick="prevstepfunc();">Back</button></td>
                                    <td style="width: 120px; text-align: center"><button type="button" class="close" style="background-color:orangered !important; opacity:1.0; width:100px; height:30px; float:none " onclick="nextstepfunc();">Next</button></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--compare Modal-->
        <div class="modal fade" id="compareModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content" id="">
                    <div class="modal-header">
                        <div id="compare_header"></div>
                    </div>
                    <div class="modal-body" id="area-chart-content">
                        <div id="compare_body"></div>
                        <div id="compare_performation"></div>
                        <div id="compare_oil"></div>
                        <div id="compare_gas"></div>
                        <div id="compare_water"></div>
                    </div>
                </div>
            </div>
        </div>

        <!--add newedit data provider Modal-->
        <div class="modal fade" id="dataproviderModal" >
            <div class="modal-dialog" style="width:800px">
                <div class="modal-content" id="">
                    <div class="modal-header">
                        <div id="dataprovider_header"><h3><label id="lbl_dprov_header"></label><label id="lbl_dprov_pkeyid"></label></h3></div>
                    </div>
                    <div class="modal-body">
                     <table>
                         <tr>
                             <td>Code:</td>
                             <td><input id="tbox_dprov_code" name="tbox_dprov_code" type="text" value="" /></td>
                             <td>Name:</td>
                             <td><input id="tbox_dprov_name" name="tbox_dprov_name" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>State:</td>
                             <td><label id="lbl_dprov_state"></label></td>
                             <td>Status:</td>
                             <td><label id="lbl_dprov_status"></label> </td>
                         </tr>
                         <tr>
                             <td>Contact First Name:</td>
                             <td><input id="tbox_dprov_contactfirstname" name="tbox_dprov_contactfirstname" type="text" value="" /></td>
                             <td>Contact Last Name:</td>
                             <td><input id="tbox_dprov_contactlastname" name="tbox_dprov_contactlastname" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Contact Title:</td>
                             <td><input id="tbox_dprov_contacttitle" name="tbox_dprov_contacttitle" type="text" value="" /></td>
                             <td>Contact Physical Address 1.</td>
                             <td><input id="tbox_dprov_contactphysaddress1" name="tbox_dprov_contactphysaddress1" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Contact Physical Address 2.</td>
                             <td><input id="tbox_dprov_contactphysaddress2" name="tbox_dprov_contactphysaddress2" type="text" value="" /></td>
                             <td>Contact Physical City:</td>
                             <td><input id="tbox_dprov_contactphyscity" name="tbox_dprov_contactphyscity" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Contact Physical State:</td>
                             <td><label id="lbl_dprov_contactphysstate"></label> </td>
                             <td>Contact Physical Zip:</td>
                             <td><input id="tbox_dprov_contactphyszip" name="tbox_dprov_contactphyszip" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Contact Phone:</td>
                             <td><input id="tbox_dprov_contactphone" name="tbox_dprov_contactphone" type="text" value="" /></td>
                             <td>Mail Address 1.</td>
                             <td><input id="tbox_dprov_mailaddr1" name="tbox_dprov_mailaddr1" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Mail Address 2.</td>
                             <td><input id="tbox_dprov_mailaddr2" name="tbox_dprov_mailaddr2" type="text" value="" /></td>
                             <td>Mail City:</td>
                             <td><input id="tbox_dprov_mailcity" name="tbox_dprov_mailcity" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Mail State:</td>
                             <td><label id="lbl_dprov_mailstate"></label>  </td>
                             <td>Mail Zip:</td>
                             <td><input id="tbox_dprov_mailzip" name="tbox_dprov_mailzip" type="text" value="" /></td>
                         </tr>
                         <tr>
                             <td>Mod. Date:</td>
                             <td><label id="lbl_dprov_moddate"></label></td>
                             <td>Mod. User:</td>
                             <td><label id="lbl_dprov_moduser"></label></td>
                         </tr>
                         <tr>
                             <td><button id="btn_dataprov_save"  data-dismiss="modal">Save</button></td><td><button id="btn_dataprov_cancell" data-dismiss="modal">Cancel</button></td>
                         </tr>
                     </table>
                    </div>
                </div>
            </div>
        </div>
        <footer class="footer">
            <div class="container">
                <p class="text-muted">Privacy Policy | Terms & Conditions</p>
                
            </div>
        </footer>
    </div>


    <script type="text/javascript">

        
        function chg_password() {

            var oldp = $('#tbox_old_pword').val();
            var newp = $('#tbox_new_pword').val();
            var conp = $('#tbox_renew_pword').val();


            if (conp == newp)
            {
                $.ajax({
                    type: "POST",
                    data: { oldp: oldp, newp: newp },
                    url: '/GatewayWeb/Home/ChangePassword',
                    async: false,
                    success: function (xhr) {

                        //  debugger;



                        if (xhr == "1") {
                            

                        }
                        else {


                        }


                    },
                    error: function (xhr, errorThrown) { alert(errorThrown); }

                });
            }
            else
            {
                alert("New Password And Confirm Password are different!")
            }
        };


        $('#href_login').click(function () {
            $.ajax({
                type: "POST",
                //data: { dataid: api, datatype: type },
                url: '/GatewayWeb/Home/ChkLogin',
                async: false,
                success: function (xhr) {

                  //  debugger;
                 
                    

                    if (xhr == "1") {
                        location.href = '/GatewayWeb/Home/AdminDashboard';

                    }
                    else {


                    }


                },
                error: function (xhr, errorThrown) { alert(errorThrown); }

            });

        });

        //login func block
        var tokenKey = 'accessToken';

        function login() {
            //$("#result").val('');
            //  debugger;


            var loginData = {
                grant_type: 'password',
                username: $("#tbox_uname").val(),
                password: $("#tbox_pword").val()
            };

            $.ajax({
                type: 'POST',
                url: '/GatewayWeb/Home/Token',//'Token',
                data: loginData
            }).done(function (data) {
                //$("#user").val(data.userName);
              //  $("#result").val('Login successful');
                // Cache the access token in session storage.
                //sessionStorage.setItem(tokenKey, data.access_token);
                location.href = '/GatewayWeb/Home/AdminDashboard';
            }).fail(
            function () {

                location.href = '/GatewayWeb/Home/AdminDashboard';
            }
            );

           
        }
        //login func block end

        function setAccordionIcon() {
            //$('.panel').on('hidden.bs.collapse', function (e) {
            //    if (e.currentTarget.id != "")
            //    $('#' + e.currentTarget.id + 'Title').removeClass("glyphicon-minus").addClass("glyphicon-plus");
            //})

            //$('.panel').on('shown.bs.collapse', function (e) {
            //    if (e.currentTarget.id != "")
            //    $('#' + e.currentTarget.id + 'Title').removeClass("glyphicon-plus").addClass("glyphicon-minus");
            //})
        }

        function setPaneTop(pane) {
            var windowTop = $(this).scrollTop();
            var titleHeight = 20;
            var titleTop = 110;
            if (windowTop > titleTop) {
                pane.style.top = titleHeight + 'px';
            } else {
                pane.style.top = titleTop + titleHeight - windowTop + 'px';
            }
        }

        function setPanesTop() {
            var panes = document.getElementsByClassName('right-pane');
            var i = 0;
            for (i = 0; panes.length > i; i++) {
                setPaneTop(panes[i]);
            }

            panes = document.getElementsByClassName('left-pane');
            for (i = 0; panes.length > i; i++) {
                setPaneTop(panes[i]);
            }
        }

        function addPaneEvents() {
            setPanesTop();

            $(window).scroll(function () {
                setPanesTop();
            });

            $('.left-pane-arrow').click(function () {
                var w = this.parentElement.clientWidth + 'px';
                if (this.parentElement.style.left == "" || this.parentElement.style.left == "0px") {
                    $('.left-pane').animate({
left:                  '+=' + w
                    }).delay(0);
                    this.childNodes[1].innerHTML = "<<";
                }
                else {
                    $('.left-pane').animate({
left:                  '-=' + w
                    }).delay(0);
                    this.childNodes[1].innerHTML = ">>";
                }
            });

            $('.right-pane-arrow').click(function () {
                var w = this.parentElement.clientWidth + 'px';
                if (browserIsIe() && hasScrollbar()) {
                    if (this.parentElement.style.right == getScrollbarWidth() + 'px') {
                        $('.right-pane').animate({
right:                         '+=' + w
                        }, 500, function () {
                            if (browserIsIe() && hasScrollbar()) {
                                moveRightPaneWhenScrollbarIsVisible();
                            }
                        });
                        this.childNodes[1].innerHTML = ">>";
                    }
                    else {
                        $('.right-pane').animate({
right:                             '-=' + w
                        }, 500, function () {
                            if (browserIsIe() && hasScrollbar()) {
                                moveRightPaneWhenScrollbarIsVisible();
                            }
                        });
                        this.childNodes[1].innerHTML = "<<";
                    }
                }
                else {
                    if (this.parentElement.style.right == "" || this.parentElement.style.right == "0px") {
                        $('.right-pane').animate({
right:                                     '+=' + w
                        }, 500, function () {
                            if (browserIsIe() && hasScrollbar()) {
                                moveRightPaneWhenScrollbarIsVisible();
                            }
                        });
                        this.childNodes[1].innerHTML = ">>";
                    }
                    else {
                        $('.right-pane').animate({
right:                                         '-=' + w
                        }, 500, function () {
                            if (browserIsIe() && hasScrollbar()) {
                                moveRightPaneWhenScrollbarIsVisible();
                            }
                        });
                        this.childNodes[1].innerHTML = "<<";
                    }
                }
            });
        }



        var hasScrollbar = function () {
            // The Modern solution
            //if (typeof window.innerWidth === 'number')
            //    return window.innerWidth > document.documentElement.clientWidth;

            // rootElem for quirksmode
            var rootElem = document.documentElement || document.body;

            // Check overflow style property on body for fauxscrollbars
            var overflowStyle;

            if (typeof rootElem.currentStyle !== 'undefined')
                overflowStyle = rootElem.currentStyle.overflow;

            overflowStyle = overflowStyle || window.getComputedStyle(rootElem, '').overflow;

            // Also need to check the Y axis overflow
            var overflowYStyle;

            if (typeof rootElem.currentStyle !== 'undefined')
                overflowYStyle = rootElem.currentStyle.overflowY;

            overflowYStyle = overflowYStyle || window.getComputedStyle(rootElem, '').overflowY;

            var contentOverflows = rootElem.scrollHeight > rootElem.clientHeight;
            var overflowShown = /^(visible|auto)$/.test(overflowStyle) || /^(visible|auto)$/.test(overflowYStyle);
            var alwaysShowScroll = overflowStyle === 'scroll' || overflowYStyle === 'scroll';

            return (contentOverflows && overflowShown) || (alwaysShowScroll);
        }

        function getScrollbarWidth() {
            var outer = document.createElement("div");
            outer.style.visibility = "hidden";
            outer.style.width = "100px";
            outer.style.msOverflowStyle = "scrollbar"; // needed for WinJS apps

            document.body.appendChild(outer);

            var widthNoScroll = outer.offsetWidth;
            // force scrollbars
            outer.style.overflow = "scroll";

            // add innerdiv
            var inner = document.createElement("div");
            inner.style.width = "100%";
            outer.appendChild(inner);

            var widthWithScroll = inner.offsetWidth;

            // remove divs
            outer.parentNode.removeChild(outer);

            return widthNoScroll - widthWithScroll;
        }

        function browserIsIe() {
            if (navigator.userAgent.indexOf('Firefox', 0) > 0)
                return false;

            if (navigator.userAgent.indexOf('Chrome', 0) > 0)
                return false;

            if (navigator.userAgent.indexOf('Safari', 0) > 0)
                return false;

            if (navigator.userAgent.indexOf('Opera', 0) > 0)
                return false;

            if (navigator.userAgent.indexOf('Apple', 0) > 0)
                return false;

            return true;
        }

        function moveRightPaneWhenScrollbarIsVisible() {
            var panes = document.getElementsByClassName('right-pane');
            var i = 0;
            var s = getScrollbarWidth();
            if (hasScrollbar()) {
                for (i = 0; panes.length > i; i++) {
                    if (panes[i].style.right == "" || panes[i].style.right == "0px") {
                        panes[i].style.right = s + 'px';
                    }

                    var w = panes[i].clientWidth + 'px';
                    if (panes[i].style.right == w) {
                        panes[i].style.right = panes[i].clientWidth + s + 'px';
                    }
                }
            }
            else {
                for (i = 0; panes.length > i; i++) {
                    if (panes[i].style.right == s + 'px') {
                        panes[i].style.right = '0px';
                    }

                    var w = panes[i].clientWidth + s + 'px';
                    if (panes[i].style.right == w) {
                        panes[i].style.right = panes[i].clientWidth + 'px';
                    }
                }
            }
        }



        $(document).ready(function () {


            $(function () {
                $.ajax({
                    type: "POST", //data: { dataid: api, datatype: type },
                    url: '/GatewayWeb/Home/IsLogged',
                    async: false,
                    success: function (xhr) {

                   //      debugger;

                        if (xhr == "1") {
                            var changepasslink = document.getElementById('link_chngpass');
                            changepasslink.style.display = "block";


                        }
                        else {


                        }


                    },
                    error: function (xhr, errorThrown) { alert(errorThrown); }

                });

            });
            addPaneEvents();

            setAccordionIcon();

            // Pinned button popover with image
            $('[data-toggle="popover"]').popover();
            $('a[rel=popover]').popover({
                html: true,
                trigger: 'hover',
                content: function () { return '<img src="' + $(this).data('img') + '" style="width: 192px; height: 115px;" />'; }
            });


     

            if (browserIsIe()) {
                moveRightPaneWhenScrollbarIsVisible();

                window.onresize = function () {
                    moveRightPaneWhenScrollbarIsVisible();
                };
            }

            loadfiltergrid();
            //loadPinnedWells();

            $('.ref_pinned_wells').click(function () {
                loadPinnedWells();
            });

            $('#btn_compare').click(function () {
                //debugger;

                $.ajax({
                    type: "GET",
                    //data: { dataid: api, datatype: type },
                    url: '/GatewayWeb/Home/GetCompareResult',
                    async: false,
                    success: function (xhr) {

                       // debugger;
                        document.getElementById('compare_header').innerHTML = xhr.header;
                        document.getElementById('compare_body').innerHTML = xhr.basetable;
                        document.getElementById('compare_performation').innerHTML = xhr.performationtable;

                        
                        if (xhr != "1") {

                        }
                        else {


                        }


                    },
                    error: function (xhr, errorThrown) { alert(errorThrown); }

                });

                drawCompareChart("Oil", $("#compare_oil"));
                drawCompareChart("Gas", $("#compare_gas"));
                drawCompareChart("Water", $("#compare_water"));
            });
        });

      
        function drawProductionTotal(type, div)
        {
            div.html("loading...");
            $.getJSON('/GatewayWeb/Home/GetProductionTotals', null)
             .done(function (result) {
                 //debugger;
                 if (result.rows.length > 0) {
                     var data = new google.visualization.DataTable(result);
                     var options;

                     options = {
                         width: 500,
                         height: 300,
                         vAxis: { format: 'decimal' }
                     };

                     if (type == 'area') {
                         var chart = new google.visualization.AreaChart(div[0]);
                         chart.draw(data, options);
                     }
                     else {
                         var chart = new google.visualization.LineChart(div[0]);
                         chart.draw(data, options);

                     }
                 }
                 else
                     div.html("<span style=\"color:green\">No production data available</span>");                
             })
             .fail(function (jqxhr, textStatus, error) {
                 div.html("<span style=\"color:red\">Could not access server content!</span>");
                // debugger;
             });
        }

        function drawCompareChart(prodType, div) {
            div.html("loading...");
            $.getJSON('/GatewayWeb/Home/GetCompareResultChart', {prodType: prodType})
             .done(function (result) {
                 //debugger;
                 if (result.rows.length > 0) {
                     var data = new google.visualization.DataTable(result);
                     var options;

                     options = {
                         width: 600,
                         height: 300,
                         vAxis: { format: 'decimal' }
                     };

                     var chart = new google.visualization.LineChart(div[0]);
                     chart.draw(data, options);
                 }
                 else
                     div.html("<span style=\"color:green\">No production data available</span>");
             })
             .fail(function (jqxhr, textStatus, error) {
                 div.html("<span style=\"color:red\">Could not access server content!</span>");
                 // debugger;
             });
        }

        function updateCharts(filterKey, divarea, divline) {
            divarea.html("loading...");
            divline.html("loading...");

            var param = null;
            if (filterKey != null)
                param = {filterKey: filterKey};

            $.getJSON('/GatewayWeb/Home/GetProductionTotals', param)
             .done(function (result) {
                 //debugger;
                 if (result.rows.length > 0) {
                     var data = new google.visualization.DataTable(result);
                     var options;

                     options = {
                         width: 500,
                         height: 300,
                         vAxis: { format: 'decimal' }
                     };

                     var chartarea = new google.visualization.AreaChart(divarea[0]);
                     chartarea.draw(data, options);
                     var chartline = new google.visualization.LineChart(divline[0]);
                     chartline.draw(data, options);
                 }
                 else {
                     divarea.html("<span style=\"color:green\">No production data available</span>");
                     divline.html("<span style=\"color:green\">No production data available</span>");
                 }                    
             })
             .fail(function (jqxhr, textStatus, error) {
                 divarea.html("<span style=\"color:red\">Could not access server content!</span>");
                 divline.html("<span style=\"color:red\">Could not access server content!</span>");
               //  debugger;
             });
        }

        function updateTotalsSum(filterKey, divoil, divgas, divwater, divwells) {
            divoil.val("");
            divgas.val("");
            divwater.val("");
            divwells.val("");

            var param = null;
            if (filterKey != null)
                param = { filterKey: filterKey };

            $.getJSON('/GatewayWeb/Home/GetProductionTotalsSum', param)
                 .done(function (result) {
                     //debugger;
                     if (result.rows.length > 0) {

                         divoil.val(result.rows[0].c[0].v);
                         divgas.val(result.rows[0].c[1].v);
                         divwater.val(result.rows[0].c[2].v);
                         divwells.val(result.rows[0].c[3].v);
                     }
                 })
                 .fail(function (jqxhr, textStatus, error) {
                    // debugger;
                 });
        }

        function SaveCompWellId(api, type) {
          //  debugger;



            //{ dataid: parrow.api, datatype: type, wellIdentifier: parrow.wellIdentifier, state: parrow.state, stateWellKey: parrow.stateWellKey, api: parrow.api, type: parrow.type, typeDescription: parrow.typeDescription, status: parrow.status, statusDescription: parrow.statusDescription, stateOperatorKey: parrow.stateOperatorKey, operatorName: parrow.operatorName, latitude: parrow.latitude, longitude: parrow.longitude, wellName: parrow.wellName, wellNumber: parrow.wellNumber, measuredDepth: parrow.measuredDepth, totalVerticalDepth: parrow.totalVerticalDepth, orientation: parrow.orientation, bottomHoleLatitude: parrow.bottomHoleLatitude, bottomHoleLongitude: parrow.bottomHoleLongitude, Info: parrow.Info, Pin: parrow.Pin },

            //add type:1 -- remove type:0
            $.ajax({
                type: "POST",
                data: { dataid: api, datatype: type },
                url: '/GatewayWeb/Home/SaveCompId',
                async: false,
                success: function (xhr) {

                    loadPinnedWells();
                    //  debugger;
                    if (xhr == "2") {
                        alert("Already pinned!");
                    }
                    else if (xhr=="1"){


                    }
                    else
                    {
                        alert(xhr);
                    }


                },
                error: function (xhr, errorThrown) { alert(errorThrown); }

            });

        }

        function loadPinnedWells()
        {
           // return;
            $.ajax({
                type: "POST",
               // data: { data: "x" },
                url: '/GatewayWeb/Home/GetCompId',
                async: false,
                success: function (xhr) {

                    $("#pinnedTotal").val(xhr.length);
                  
                    var contenttable = "<table>";

                    xhr.forEach(function (entry) {

                       

                        contenttable += "<tr><td style='width:200px'><a id='pinn_" + entry.apinum + "' class='btn btn-default btn-sm disable-border-radius pinned-element tooltiptargetclass' href='#' role='button' rel='popover2' data-toggle='popover'><div>API.:" + entry.apinum + "</div></a><div style='display:none'><div id='pop_" + entry.apinum + "'></div></div></td><td><button id='" + entry.apinum + "' class='btn_remove'>X</button></td></tr> "      //"<tr><td>" + entry.wellindentifier + "</td></tr>";

                   
                    });

                    contenttable += "</table>";

                    document.getElementById('pinnlistplace').innerHTML = contenttable;
                    // add popup content
                    var options = {
                        displayAnnotations: true,
                        width: 230,
                        height: 200,
                        vAxis: { logScale: false },
                        hAxis: { title: 'Year', format: '####' }
                    };
                    xhr.forEach(function (entry) {
                        var data = new google.visualization.DataTable(entry.production);
                        var popdiv = document.getElementById("pop_" + entry.apinum);

                        var chart = new google.visualization.LineChart(popdiv);
                        chart.draw(data, options);

                        $('#pinn_' + entry.apinum).popover({
                            html: true,
                            trigger: "hover",
                            placement: "left",
                            content: popdiv.innerHTML
                        });
                    });

                    $('.btn_remove').click(function (event) {
                        
                        var remid = event.target.id;

                        removepinnedfunc(remid);
                    });

                },
                error: function (xhr, errorThrown) { alert(errorThrown); }

            });
        }

        function removepinnedfunc(id)
        {
            
            $.ajax({
                type: "POST",
                data: { dataid: id, datatype:0 },
                url: '/GatewayWeb/Home/SaveCompId',
                async: false,
                success: function (xhr) {

                    loadPinnedWells();
                    
                },
                error: function (xhr, errorThrown) { alert(errorThrown); }

            });

        }

        function loadfiltergrid() {
            //filter grid
            $(document).ready(function () {

                jQuery("#filter").jqGrid({
                    url: '/GatewayWeb/Home/GetSearchControlls',
                    datatype: "json",
                    colNames: ["id", "Filter"],
                    colModel: [
                            { name: "id", width: 1, key: true, hidden: true },
                            {
                                name: "name", width: 250, sortable: false,
                                formatter: function (cellvalue, options, rowObject) {
                                    return "<input type='checkbox' class='itmchk' checked>" + $.jgrid.htmlEncode(cellvalue);
                                }
                            }
                    ],
                    sortname: "id",
                    sortorder: "asc",
                    treeGrid: true,
                    caption: "Filter Attributes",
                    treeGridModel: "adjacency",
                    ExpandColumn: "name",
                    jsonReader: { repeatitems: false, root: function (obj) { return obj; } },
mtype:             'GET',
                    height: "auto",
pager:             '#pfilter',
                    loadComplete: function (data) {
                        var $this = $(this),
                                localIdName = $this.jqGrid("getGridParam", "localReader").id;
                        for (var i = 0; i < data.length; i++) {
                            var parent = $this.jqGrid("getNodeParent", data[i]);
                            if (parent != null) {
                                if ($("#" + parent[localIdName] + " input.itmchk").prop("indeterminate") == true) {
                                    if (data[i]["check"] == 0)
                                        $("#" + data[i]["id"] + " input.itmchk").prop("checked", false);
                                }
                                else if ($("#" + parent[localIdName] + " input.itmchk").prop("checked") != true)
                                    $("#" + data[i]["id"] + " input.itmchk").prop("checked", false);
                            }
                            if (data[i]["check"] == 2) {
                                $("#" + data[i]["id"] + " input.itmchk").prop("indeterminate", true);
                                $("#" + data[i]["id"] + " input.itmchk").prop("checked", false);
                            }
                        }
                    },
                    beforeSelectRow: function (rowid, e) {
                        var $this = $(this),
                                isLeafName = $this.jqGrid("getGridParam", "treeReader").leaf_field,
                                localIdName = $this.jqGrid("getGridParam", "localReader").id,
                                localData,
                                state,
                                setChechedStateOfChildrenItems = function (children) {
                                    $.each(children, function () {
                                        $("#" + this[localIdName] + " input.itmchk").prop("checked", state);
                                        if (!this[isLeafName]) {
                                            setChechedStateOfChildrenItems($this.jqGrid("getNodeChildren", this));
                                        }
                                    });
                                },
                                setIndeterminateStateOfParentItem = function (child) {
                                    var parent = $this.jqGrid("getNodeParent", child),
                                        allchecked = true,
                                        allunchecked = true;
                                    if (parent != null) {
                                        $.each($this.jqGrid("getNodeChildren", parent), function () {
                                            if ($("#" + this[localIdName] + " input.itmchk").prop("checked"))
                                                allunchecked = false;
                                               else
                                                allchecked = false;
                                            if ($("#" + this[localIdName] + " input.itmchk").prop("indeterminate"))
                                                allunchecked = false;
                                        });

                                        $("#" + parent[localIdName] + " input.itmchk").prop("checked", allchecked);
                                        $("#" + parent[localIdName] + " input.itmchk").prop("indeterminate", !allchecked && !allunchecked);
                                        setIndeterminateStateOfParentItem(parent);
                                    }
                                };
                        if (e.target.nodeName === "INPUT" && $(e.target).hasClass("itmchk")) {
                            state = $(e.target).prop("checked");
                            localData = $this.jqGrid("getLocalRow", rowid);
                            setChechedStateOfChildrenItems($this.jqGrid("getNodeChildren", localData), state);
                            setIndeterminateStateOfParentItem(localData);
                        }
                    }
                });
            });

        }

        google.load('visualization', '1', { 'packages': ['corechart', 'bar'] });
    </script>
         </body>
</html>
